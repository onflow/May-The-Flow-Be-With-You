## Prerequisite
1. Node.js (npm), can use nvm or fnm for node management
2. Flow (incl. flow-cli)

## How to Run
1. Copy `.env.example` into `.env` and replace it with Gemini API that you can get from [here](https://aistudio.google.com/).
2. Deploy the `GiftCard.cdc` cadence contract located in `cadence/contracts` folder (refer to flow doc [here](https://developers.flow.com/build/getting-started/flow-cli)). Don't forget to start the emulator if you deploy locally. Contract has also been deployed to testnet, refer to `flow.json` to get the address.
3. Navigate to `week4/GenerativeGiftCard/src/app/my-cards/page.tsx` and `week4/GenerativeGiftCard/src/utils/flow.ts` to change the address of contract depending on deployed environments.
4. Run the app by navigating to `week4/GenerativeGiftCard` and run command such as `npm i` followed by `npm run dev`. 
5. If you don't want to deploy contract in emulator, run step 4 to test against contract deployed on testnet.

## How to Test
1. Go to deployed URL of the web app and login with your an address in your wallet.
2. Create a gift card and give to to 2nd address in your wallet any amount you'd like to give. When creating gift card, put some context on for what purpose, who is the person, and any additional information and let AI generate the message.
3. Image generation is currently hard coded.
4. Create the gift card by approving in wallet.
5. Login as 2nd address in wallet.
6. Navigate to `My Gift Cards` page.
7. See the image and greeting and withdraw from the gift card to your address.

## Prompt for Development
**Cadence**:
1. I plan to build a gift card app using flow blockchain (cadence) and nextjs. First, let's design smart contract in cadence that can store the gift card data (cadence will store many gift cards and one user can be given more than 1 gift card). Gift card will have following fields: value (in flow token), message (string), status (allocated, withdrawn), image (ipfs url). Gift card doesn't need to be NFT can be assigned to a flow address. The contract (could be transaction  or scripts) should provide means to quickly extract list of gift cards assigned to an address, it also must allow address to withdraw the token, and change the status accordingly to withdrawn. When creating a new gift card, ipfs url, message, and value will be mandatory, status will be allocated when created because when creating the assignment to flow address will also happen. Based on above requirements, pls generate cadence files

2. Failed to deploy @GiftCard.cdc with these errors (the real error message) . pls propose the fix referring to @Cadence as source of truth.

**Frontend**: 
1. Based on contract stored in /Users/user/FlowProject/May-The-Flow-Be-With-You/submissions/0x7b75fc721f893cb2/week4/test/cadence, create equivalent nextjs code to allow a user to create gift card (including upload image and store in ipfs). Message and image can be generated by AI LLM (by getting the input from user). Use gemini for message and image generation

2. You also need to create an interface for recipient to view list of gift cards he/she has and do withdraw. The displayed gift card must display value, status, message, and image in the web. For image generation, pls use Imagen API, refer to this @https://colab.research.google.com/github/google-gemini/cookbook/blob/main/quickstarts/Get_started_imagen.ipynb for reference how to generate image using Imagen.

## Next Step
1. Implement the generative image instead of only placeholder image.
2. Implement upload image to ipfs.
3. Smart contract security enhancement.
4. Deploy contract to mainnet.
5. Deploy app to accessible server.